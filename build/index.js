(()=>{"use strict";var e={n:s=>{var t=s&&s.__esModule?()=>s.default:()=>s;return e.d(t,{a:t}),t},d:(s,t)=>{for(var n in t)e.o(t,n)&&!e.o(s,n)&&Object.defineProperty(s,n,{enumerable:!0,get:t[n]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.wp.element,t=window.React;var n=e.n(t);const i=window.ReactJSXRuntime,a=({activeView:e,onChangeView:s,settings:t})=>{const n="1"===t.email_logging,a=e=>{("email_logs"!==e||n)&&s(e)};return(0,i.jsx)("div",{className:"wcso-sidebar",children:(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{className:"create_order"===e?"active":"",onClick:()=>a("create_order"),children:[(0,i.jsx)("span",{className:"dashicons dashicons-cart"})," Create Order"]}),(0,i.jsxs)("li",{className:"settings"===e?"active":"",onClick:()=>a("settings"),children:[(0,i.jsx)("span",{className:"dashicons dashicons-admin-settings"})," Settings"]}),(0,i.jsxs)("li",{className:"analytics"===e?"active":"",onClick:()=>a("analytics"),children:[(0,i.jsx)("span",{className:"dashicons dashicons-chart-bar"})," Analytics"]}),(0,i.jsxs)("li",{className:`${"email_logs"===e?"active":""} ${n?"":"wcso-disabled"}`,onClick:()=>a("email_logs"),title:n?"":"Enable 'Email Debug Logging' in Settings to access this feature.",style:n?{}:{opacity:.5,cursor:"not-allowed",background:"#f8f8f8"},children:[(0,i.jsx)("span",{className:"dashicons dashicons-email-alt"})," Email Log"]})]})})},o={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1e4,display:"flex",justifyContent:"center",alignItems:"center"},modal:{background:"#fff",padding:"20px",borderRadius:"5px",width:"400px",maxWidth:"90%",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px",borderBottom:"1px solid #eee",paddingBottom:"10px"},closeBtn:{background:"none",border:"none",fontSize:"20px",cursor:"pointer"},list:{maxHeight:"300px",overflowY:"auto",border:"1px solid #eee"},item:{padding:"10px",borderBottom:"1px solid #eee",cursor:"pointer",transition:"background 0.2s"}},r=({results:e,onSelect:s,onClose:t})=>e&&0!==e.length?(0,i.jsx)("div",{className:"wcso-modal-overlay",style:o.overlay,children:(0,i.jsxs)("div",{className:"wcso-modal-content",style:o.modal,children:[(0,i.jsxs)("div",{style:o.header,children:[(0,i.jsx)("h2",{style:{margin:0},children:"Multiple Products Found"}),(0,i.jsx)("button",{onClick:t,style:o.closeBtn,children:"×"})]}),(0,i.jsxs)("p",{children:["The scanned code matched ",(0,i.jsx)("strong",{children:e.length})," products. Please select one:"]}),(0,i.jsx)("div",{style:o.list,children:e.map(e=>(0,i.jsxs)("div",{onClick:()=>s(e),style:o.item,children:[(0,i.jsx)("strong",{children:e.name}),(0,i.jsx)("br",{}),(0,i.jsxs)("small",{children:["SKU: ",e.sku]}),(0,i.jsx)("span",{style:{float:"right"},children:e.price_html})]},e.id))})]})}):null,l=({onAddProduct:e})=>{const[s,n]=(0,t.useState)(""),[a,o]=(0,t.useState)([]),[l,c]=(0,t.useState)([]),[d,p]=(0,t.useState)(!1),[h,m]=(0,t.useState)("checking"),[g,u]=(0,t.useState)(null),x=(0,t.useRef)(null),j="wcso_all_products",w="wcso_cache_time",_="yes"===window.wcsoData.initialSettings.barcode_scanner;(0,t.useEffect)(()=>{y()},[]),(0,t.useEffect)(()=>{_&&x.current&&a.length>0&&x.current.focus()},[_,a]),(0,t.useEffect)(()=>{if(s.length<2)return void c([]);const e=s.toLowerCase(),t=a.filter(s=>{const t=s.name.toLowerCase(),n=s.sku?s.sku.toLowerCase():"",i=String(s.id);return t.includes(e)||n.includes(e)||i.includes(e)});c(t.slice(0,20))},[s,a]);const y=()=>{const e=localStorage.getItem(j),s=localStorage.getItem(w),t=Date.now();if(e&&s&&t-s<864e5)try{o(JSON.parse(e)),m("loaded")}catch(e){v()}else v()},v=()=>{m("loading"),p(!0),window.jQuery.post(window.wcsoData.ajaxUrl,{action:"wcso_get_all_products",nonce:window.wcsoData.cacheNonce},e=>{p(!1),e.success?(o(e.data),m("loaded"),localStorage.setItem(j,JSON.stringify(e.data)),localStorage.setItem(w,Date.now())):m("error")}).fail(()=>{p(!1),m("error")})};return(0,i.jsxs)("div",{className:"wcso-search-box",children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,i.jsxs)("h3",{children:[(0,i.jsx)("span",{className:"dashicons dashicons-search"})," Add Products"]}),(0,i.jsxs)("div",{style:{fontSize:"12px"},children:["loading"===h&&(0,i.jsx)("span",{className:"spinner is-active",style:{float:"none",margin:"0 5px"}}),"loaded"===h&&(0,i.jsxs)("span",{style:{color:"#46b450",marginRight:"10px"},children:["● ",a.length," Cached"]}),"error"===h&&(0,i.jsx)("span",{style:{color:"#dc3232",marginRight:"10px"},children:"● Failed"}),(0,i.jsx)("button",{type:"button",onClick:()=>{localStorage.removeItem(j),localStorage.removeItem(w),o([]),c([]),v()},className:"button button-small",disabled:"loading"===h,children:"Refresh"})]})]}),_&&(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"600",color:"#2271b1"},children:[(0,i.jsx)("span",{className:"dashicons dashicons-smartphone"})," Scan Barcode (Auto-Focused)"]}),(0,i.jsx)("input",{ref:x,type:"text",placeholder:"Click here & scan...",onKeyDown:s=>{if("Enter"===s.key){s.preventDefault();const t=s.target.value.trim().toLowerCase();if(console.log("[SCANNER] Enter detected. Code:",t),!t||0===a.length)return;const n=a.filter(e=>{const s=e.sku?e.sku.toLowerCase():"",n=String(e.id);return s===t||n===t});1===n.length?(e(n[0]),s.target.value="",s.target.style.backgroundColor="#eaffea",s.target.style.borderColor="#46b450",setTimeout(()=>{s.target&&(s.target.style.backgroundColor="#f0f6fc",s.target.style.borderColor="#2271b1")},300)):n.length>1?(u(n),s.target.value=""):(console.warn("[SCANNER] No match for:",t),s.target.style.backgroundColor="#ffebeb",s.target.style.borderColor="#d63638",setTimeout(()=>{s.target&&(s.target.style.backgroundColor="#f0f6fc",s.target.style.borderColor="#2271b1")},300))}},className:"wcso-input-large",style:{backgroundColor:"#f0f6fc",borderColor:"#2271b1",borderWidth:"2px",transition:"all 0.2s",boxShadow:"0 0 5px rgba(34, 113, 177, 0.2)"}}),(0,i.jsx)("div",{className:"wcso-or-divider",style:{margin:"15px 0",textAlign:"center",color:"#ccc",fontSize:"11px",textTransform:"uppercase",letterSpacing:"1px"},children:"— OR —"})]}),(0,i.jsxs)("div",{className:"wcso-search-input-wrapper",children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",color:"#666"},children:"Manual Search"}),(0,i.jsx)("input",{type:"text",placeholder:"Type Name or SKU...",value:s,onChange:e=>n(e.target.value),className:"wcso-input-large"})]}),l.length>0&&(0,i.jsx)("div",{className:"wcso-search-results",children:l.map(s=>(0,i.jsxs)("div",{className:"wcso-result-item",onClick:()=>{e(s),n(""),c([])},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:s.name}),(0,i.jsxs)("div",{style:{fontSize:"11px",color:"#666"},children:["SKU: ",s.sku||"N/A"]})]}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsx)("span",{className:`wcso-badge status-${s.status}`,children:s.status}),(0,i.jsx)("div",{className:"wcso-price",children:s.price_html})]})]},s.id))}),g&&(0,i.jsx)(r,{results:g,onSelect:s=>{e(s),u(null)},onClose:()=>u(null)})]})},c=({cart:e,onUpdateQty:s,onRemove:t})=>{const n=e.reduce((e,s)=>e+parseFloat(s.price)*s.quantity,0);return(0,i.jsxs)("div",{className:"wcso-cart-wrapper",children:[(0,i.jsxs)("h3",{children:[(0,i.jsx)("span",{className:"dashicons dashicons-cart"})," Selected Items (",e.length,")"]}),0===e.length?(0,i.jsx)("div",{className:"wcso-empty-cart",children:(0,i.jsx)("p",{children:"No products selected yet."})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("table",{className:"wcso-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Product"}),(0,i.jsx)("th",{children:"Price"}),(0,i.jsx)("th",{children:"Qty"}),(0,i.jsx)("th",{children:"Total"}),(0,i.jsx)("th",{})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{children:[(0,i.jsx)("strong",{children:e.name}),(0,i.jsx)("br",{}),(0,i.jsxs)("small",{className:"wcso-sku",children:["SKU: ",e.sku]})]}),(0,i.jsx)("td",{children:e.price}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{type:"number",min:"1",value:e.quantity,onChange:t=>s(e.id,parseInt(t.target.value)),className:"wcso-qty-input"})}),(0,i.jsx)("td",{children:(e.price*e.quantity).toFixed(2)}),(0,i.jsx)("td",{children:(0,i.jsx)("button",{className:"wcso-remove-btn",onClick:()=>t(e.id),children:"×"})})]},e.id))})]}),(0,i.jsxs)("div",{className:"wcso-cart-total",children:[(0,i.jsx)("span",{children:"Original Total:"}),(0,i.jsx)("strong",{children:n.toFixed(2)})]})]})]})},d=({cartTotal:e})=>{const s=window.wcsoData.tierConfig;let t={msg:"",color:"",icon:""};return t=e<=0?{msg:"Add products to calculate tier...",color:"grey",icon:"dashicons-minus"}:e<=15?{msg:`Auto-Approved (${s.t1.name})`,color:"#46b450",icon:"dashicons-yes-alt"}:e<=100?{msg:`Approval Needed: ${s.t2.name}`,color:"#f0b849",icon:"dashicons-warning"}:{msg:`Approval Needed: ${s.t3.name}`,color:"#d63638",icon:"dashicons-shield"},(0,i.jsxs)("div",{className:"wcso-tier-box",style:{borderLeftColor:t.color},children:[(0,i.jsx)("span",{className:`dashicons ${t.icon}`,style:{color:t.color}}),(0,i.jsx)("span",{className:"wcso-tier-text",children:t.msg})]})},p=({formData:e,setFormData:s})=>{const{countries:n,states:a,shippingZones:o,users:r}=window.wcsoData,[l,c]=(0,t.useState)({}),[d,p]=(0,t.useState)([]);(0,t.useEffect)(()=>{const s=e.shipping_country;a[s]?c(a[s]):c({})},[e.shipping_country,a]),(0,t.useEffect)(()=>{let t=null;for(let s of o){for(let n of s.zone_locations)if("country"===n.type&&n.code===e.shipping_country){t=s;break}if(t)break}const n=t?t.shipping_methods:[];if(p(n),n.length>0){const e=n[0];s(s=>({...s,shipping_method:e.method_id,shipping_method_id:e.method_id,shipping_method_title:e.instance_title,shipping_method_cost:e.instance_cost,shipping_method_instance_id:e.instance_id}))}else s(e=>({...e,shipping_method:"",shipping_method_id:"",shipping_method_title:"",shipping_method_cost:"",shipping_method_instance_id:""}))},[e.shipping_country,o,s]);const h=e=>{const{name:t,value:n}=e.target;s(e=>({...e,[t]:n}))};return(0,i.jsxs)("div",{className:"wcso-form-wrapper",children:[(0,i.jsxs)("h3",{className:"wcso-section-header",children:[(0,i.jsx)("span",{className:"dashicons dashicons-admin-users"})," Billing Information"]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsx)("label",{children:"Billed To (Sales Rep / Employee)"}),(0,i.jsx)("select",{name:"billing_user_id",value:e.billing_user_id,onChange:h,className:"wcso-input",style:{fontWeight:"bold"},children:r.map(e=>(0,i.jsxs)("option",{value:e.ID,children:[e.display_name," (",e.user_email,")"]},e.ID))}),(0,i.jsx)("p",{className:"description",style:{marginTop:"5px",color:"#666",fontSize:"12px"},children:"Defaults to current user."})]}),(0,i.jsx)("hr",{className:"wcso-divider",style:{margin:"25px 0",border:"0",borderTop:"1px solid #eee"}}),(0,i.jsxs)("h3",{className:"wcso-section-header",children:[(0,i.jsx)("span",{className:"dashicons dashicons-location"})," Shipping Information"]}),(0,i.jsxs)("div",{className:"wcso-grid-2",children:[(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["First Name ",(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),(0,i.jsx)("input",{type:"text",name:"shipping_first_name",value:e.shipping_first_name,onChange:h,className:"wcso-input"})]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["Last Name ",(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),(0,i.jsx)("input",{type:"text",name:"shipping_last_name",value:e.shipping_last_name,onChange:h,className:"wcso-input"})]})]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsx)("label",{children:"Company (optional)"}),(0,i.jsx)("input",{type:"text",name:"shipping_company",value:e.shipping_company,onChange:h,className:"wcso-input"})]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["Country / Region ",(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),(0,i.jsxs)("select",{name:"shipping_country",value:e.shipping_country,onChange:h,className:"wcso-input",children:[(0,i.jsx)("option",{value:"",children:"Select Country..."}),Object.entries(n).map(([e,s])=>(0,i.jsx)("option",{value:e,children:s},e))]})]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["Street address ",(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),(0,i.jsx)("input",{type:"text",name:"shipping_address_1",value:e.shipping_address_1,onChange:h,className:"wcso-input",placeholder:"House number and street name"})]}),(0,i.jsx)("div",{className:"wcso-form-group",children:(0,i.jsx)("input",{type:"text",name:"shipping_address_2",value:e.shipping_address_2,onChange:h,className:"wcso-input",placeholder:"Apartment, suite, unit, etc. (optional)"})}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["Town / City ",(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),(0,i.jsx)("input",{type:"text",name:"shipping_city",value:e.shipping_city,onChange:h,className:"wcso-input"})]}),(0,i.jsxs)("div",{className:"wcso-grid-2",children:[(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["State / District"," ",Object.keys(l).length>0&&(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),Object.keys(l).length>0?(0,i.jsxs)("select",{name:"shipping_state",value:e.shipping_state,onChange:h,className:"wcso-input",children:[(0,i.jsx)("option",{value:"",children:"Select State..."}),Object.entries(l).map(([e,s])=>(0,i.jsx)("option",{value:e,children:s},e))]}):(0,i.jsx)("input",{type:"text",name:"shipping_state",value:e.shipping_state,onChange:h,className:"wcso-input",placeholder:"Enter state / district"})]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["Postcode / ZIP ",(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),(0,i.jsx)("input",{type:"text",name:"shipping_postcode",value:e.shipping_postcode,onChange:h,className:"wcso-input"})]})]}),(0,i.jsxs)("div",{className:"wcso-grid-2",children:[(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsx)("label",{children:"Phone (optional)"}),(0,i.jsx)("input",{type:"text",name:"shipping_phone",value:e.shipping_phone,onChange:h,className:"wcso-input"})]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsx)("label",{children:"Email address (optional)"}),(0,i.jsx)("input",{type:"email",name:"shipping_email",value:e.shipping_email,onChange:h,className:"wcso-input",placeholder:"recipient@example.com"})]})]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["Shipping Method ",(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),(0,i.jsxs)("select",{name:"shipping_method",value:e.shipping_method,onChange:e=>{const t=e.target.value,n=d.find(e=>e.method_id===t);s(n?e=>({...e,shipping_method:t,shipping_method_id:n.method_id,shipping_method_title:n.instance_title,shipping_method_cost:n.instance_cost,shipping_method_instance_id:n.instance_id}):e=>({...e,shipping_method:""}))},className:"wcso-input",children:[0===d.length&&(0,i.jsx)("option",{value:"",children:"No methods available"}),d.map(e=>(0,i.jsxs)("option",{value:e.method_id,children:[e.instance_title," (",e.instance_cost>0?e.instance_cost:"Free",")"]},e.method_id))]})]}),(0,i.jsx)("hr",{className:"wcso-divider",style:{margin:"25px 0",border:"0",borderTop:"1px solid #eee"}}),(0,i.jsxs)("h3",{className:"wcso-section-header",children:[(0,i.jsx)("span",{className:"dashicons dashicons-clipboard"})," Additional Information"]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsxs)("label",{children:["Sample Category ",(0,i.jsx)("span",{className:"wcso-required",children:"*"})]}),(0,i.jsxs)("select",{name:"sample_category",value:e.sample_category,onChange:h,className:"wcso-input",children:[(0,i.jsx)("option",{value:"Customer Service",children:"Customer Service"}),(0,i.jsx)("option",{value:"Sales Reps",children:"Sales Reps"}),(0,i.jsx)("option",{value:"Promotions",children:"Promotions"})]})]}),(0,i.jsxs)("div",{className:"wcso-form-group",children:[(0,i.jsx)("label",{children:"Order Note"}),(0,i.jsx)("textarea",{name:"order_note",value:e.order_note,onChange:h,className:"wcso-input",rows:"4",placeholder:"Add any special instructions..."})]})]})},h=()=>{const[e,s]=(0,t.useState)([]),[n,a]=(0,t.useState)(!1),[o,r]=(0,t.useState)(null),[h,m]=(0,t.useState)({billing_user_id:window.wcsoData.currentUserId||"",shipping_first_name:"",shipping_last_name:"",shipping_company:"",shipping_country:window.wcsoData.baseCountry||"US",shipping_address_1:"",shipping_address_2:"",shipping_city:"",shipping_state:window.wcsoData.baseState||"",shipping_postcode:"",shipping_phone:"",shipping_email:"",shipping_method:"",sample_category:"Customer Service",order_note:"",shipping_method_id:"",shipping_method_title:"",shipping_method_cost:"",shipping_method_instance_id:""}),g=e.reduce((e,s)=>e+parseFloat(s.price)*s.quantity,0),u=(t,n)=>{n<1||s(e.map(e=>e.id===t?{...e,quantity:n}:e))};return(0,i.jsxs)("div",{className:"wcso-create-layout",children:[(0,i.jsxs)("div",{className:"wcso-col-left",children:[(0,i.jsx)(l,{onAddProduct:t=>{o&&r(null);const n=e.find(e=>e.id===t.id);n?u(t.id,n.quantity+1):s([...e,{...t,quantity:1}])}}),(0,i.jsx)(p,{formData:h,setFormData:m})]}),(0,i.jsxs)("div",{className:"wcso-col-right",children:[(0,i.jsx)(d,{cartTotal:g}),(0,i.jsx)(c,{cart:e,onUpdateQty:u,onRemove:t=>{s(e.filter(e=>e.id!==t))}}),(0,i.jsx)("button",{className:"button button-primary button-large wcso-submit-btn",onClick:()=>{if(0===e.length)return alert("Please add products.");const t=["shipping_first_name","shipping_last_name","shipping_address_1","shipping_city","shipping_country","shipping_postcode","shipping_method"];for(let e of t)if(!h[e]||""===h[e].trim()){const s=e.replace("shipping_","").replace(/_/g," ");return alert(`Field Required: ${s}`)}const n=window.wcsoData.states[h.shipping_country];if(n&&Object.keys(n).length>0&&!h.shipping_state)return alert("Field Required: State / District");a(!0),r(null);const i=window.wcsoData.tierConfig;let o="Approval: Not Needed";o=g<=15?"Approval: Not Needed (Tier 1 Auto-Approve)":g<=100?`Approval: Needed by ${i.t2.name} (Tier 2)`:`Approval: Needed by ${i.t3.name} (Tier 3)`;const l=window.wcsoData.users.find(e=>e.ID==h.billing_user_id),c=l?`${l.display_name} (${l.user_email})`:"Unknown",d=h.order_note,p=`\n------------\nOrder by: ${c}\nOrder total: ${g.toFixed(2)}\n${o}`,u=d?d+"\n"+p:p,x={action:"wcso_create_order",nonce:window.wcsoData.createOrderNonce,products:JSON.stringify(e),...h,order_note:u,billing_user_id:h.billing_user_id||window.wcsoData.currentUserId};window.jQuery.ajax({url:window.wcsoData.ajaxUrl,type:"POST",data:x,success:e=>{a(!1),e.success?(r(e.data),s([]),m(e=>({...e,shipping_first_name:"",shipping_last_name:"",shipping_company:"",shipping_address_1:"",shipping_address_2:"",shipping_city:"",shipping_postcode:"",shipping_phone:"",shipping_email:"",order_note:""}))):alert("Error: "+(e.data||"Unknown error"))},error:(e,s,t)=>{a(!1),console.error("AJAX Error:",t),alert("System Error: The server rejected the request.")}})},disabled:n,children:n?"Creating...":"Create Sample Order"}),o&&(0,i.jsx)("div",{className:"notice notice-success",style:{marginTop:"15px",padding:"12px",borderLeft:"4px solid #46b450",boxShadow:"0 1px 1px rgba(0,0,0,0.04)",background:"#fff"},children:(0,i.jsxs)("p",{style:{margin:0,fontSize:"14px"},children:[(0,i.jsx)("strong",{children:"✓ Order Created! "}),(0,i.jsxs)("a",{href:o.order_url,target:"_blank",rel:"noreferrer",style:{textDecoration:"none"},children:["View Order #",o.order_id," →"]})]})})]})]})},m=({appSettings:e,onUpdateSetting:s})=>{const[a,o]=(0,t.useState)(e),[r,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)(null);n().useEffect(()=>{o(e)},[e]);const p=(e,s,t)=>{o(n=>({...n,tiers:{...n.tiers,[e]:{...n.tiers[e],[s]:t}}}))},h=(e,t)=>{const n={...a,[e]:t};o(n),"email_logging"===e&&s(e,t)};return(0,i.jsxs)("div",{className:"wcso-settings-wrapper",children:[(0,i.jsx)("h2",{children:"Plugin Configuration"}),c&&(0,i.jsx)("div",{className:`wcso-notice ${c.type}`,children:c.text}),(0,i.jsxs)("div",{className:"wcso-card",children:[(0,i.jsx)("h3",{children:"General Options"}),(0,i.jsxs)("div",{className:"wcso-field-row",children:[(0,i.jsx)("label",{children:"Discount Coupon Code"}),(0,i.jsx)("input",{type:"text",value:a.coupon_code,onChange:e=>h("coupon_code",e.target.value)})]}),(0,i.jsx)("div",{className:"wcso-field-row",children:(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"checkbox",checked:"yes"===a.barcode_scanner,onChange:e=>h("barcode_scanner",e.target.checked?"yes":"no")}),"Enable Barcode Scanner Mode"]})}),(0,i.jsxs)("div",{className:"wcso-field-row",children:[(0,i.jsxs)("label",{style:{fontWeight:"bold",color:"1"===a.email_logging?"#2271b1":"inherit"},children:[(0,i.jsx)("input",{type:"checkbox",checked:"1"===a.email_logging,onChange:e=>h("email_logging",e.target.checked?"1":"0")}),"Enable Email Debug Logging"]}),(0,i.jsx)("small",{children:'Enables the "Email Log" menu in the sidebar. Useful for checking approval links.'})]})]}),(0,i.jsxs)("div",{className:"wcso-card",style:{borderLeft:"4px solid #46b450"},children:[(0,i.jsx)("h3",{children:"Tier 1: Auto-Approval"}),(0,i.jsxs)("div",{className:"wcso-grid-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Label Name"}),(0,i.jsx)("input",{type:"text",value:a.tiers.t1.name,onChange:e=>p("t1","name",e.target.value)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Limit ($)"}),(0,i.jsx)("input",{type:"number",value:a.tiers.t1.limit,onChange:e=>p("t1","limit",e.target.value)})]})]})]}),(0,i.jsxs)("div",{className:"wcso-card",style:{borderLeft:"4px solid #f0b849"},children:[(0,i.jsx)("h3",{children:"Tier 2: Manager Approval"}),(0,i.jsxs)("div",{className:"wcso-grid-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Label Name"}),(0,i.jsx)("input",{type:"text",value:a.tiers.t2.name,onChange:e=>p("t2","name",e.target.value)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Approver Email"}),(0,i.jsx)("input",{type:"email",value:a.tiers.t2.email,onChange:e=>p("t2","approver",e.target.value)})]})]})]}),(0,i.jsxs)("div",{className:"wcso-card",style:{borderLeft:"4px solid #d63638"},children:[(0,i.jsx)("h3",{children:"Tier 3: Executive Approval"}),(0,i.jsxs)("div",{className:"wcso-grid-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Label Name"}),(0,i.jsx)("input",{type:"text",value:a.tiers.t3.name,onChange:e=>p("t3","name",e.target.value)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"Approver Email"}),(0,i.jsx)("input",{type:"email",value:a.tiers.t3.email,onChange:e=>p("t3","approver",e.target.value)})]})]})]}),(0,i.jsx)("button",{className:"button button-primary button-large",onClick:()=>{l(!0),d(null),window.jQuery.post(window.wcsoData.ajaxUrl,{action:"wcso_save_settings",nonce:window.wcsoData.saveSettingsNonce,settings:a},e=>{l(!1),e.success?(d({type:"success",text:"Settings Saved!"}),s("email_logging",a.email_logging),setTimeout(()=>d(null),3e3)):d({type:"error",text:"Error saving settings."})})},disabled:r,children:r?"Saving...":"Save Settings"})]})},g=()=>(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"Analytics"}),(0,i.jsx)("p",{children:"Charts will go here."})]}),u=()=>{const[e,s]=(0,t.useState)("Loading logs..."),[n,a]=(0,t.useState)(!1);(0,t.useEffect)(()=>{o()},[]);const o=()=>{window.jQuery.post(window.wcsoData.ajaxUrl,{action:"wcso_get_email_log",nonce:window.wcsoData.saveSettingsNonce},e=>{e.success?s(e.data):s("Failed to load logs.")})};return(0,i.jsxs)("div",{className:"wcso-settings-wrapper",style:{maxWidth:"100%"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,i.jsx)("h2",{style:{margin:0},children:"System Email Logs"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,i.jsx)("button",{className:"button",onClick:o,children:"Refresh"}),(0,i.jsx)("button",{className:"button",onClick:()=>{confirm("Are you sure you want to clear the logs?")&&(a(!0),window.jQuery.post(window.wcsoData.ajaxUrl,{action:"wcso_clear_log",nonce:window.wcsoData.saveSettingsNonce},e=>{a(!1),e.success&&s("No emails logged yet.")}))},disabled:n,children:n?"Clearing...":"Clear Log"})]})]}),(0,i.jsx)("div",{className:"wcso-card",style:{padding:0,overflow:"hidden"},children:(0,i.jsx)("textarea",{readOnly:!0,value:e,style:{width:"100%",height:"600px",padding:"20px",fontFamily:"monospace",fontSize:"12px",border:"none",resize:"none",background:"#f6f7f7",color:"#333",lineHeight:"1.5"}})})]})},x=()=>{const[e,s]=(0,t.useState)("create_order"),[n,o]=(0,t.useState)(window.wcsoData.initialSettings),r=(e,s)=>{o(t=>({...t,[e]:s}))};return(0,i.jsxs)("div",{className:"wcso-app-wrapper",children:[(0,i.jsx)(a,{activeView:e,onChangeView:s,settings:n}),(0,i.jsx)("div",{className:"wcso-content-area",children:(()=>{switch(e){case"create_order":default:return(0,i.jsx)(h,{});case"settings":return(0,i.jsx)(m,{appSettings:n,onUpdateSetting:r});case"analytics":return(0,i.jsx)(g,{});case"email_logs":return"1"===n.email_logging?(0,i.jsx)(u,{}):(0,i.jsx)(h,{})}})()})]})};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("wcso-root");e&&(0,s.createRoot)(e).render((0,i.jsx)(x,{}))})})();